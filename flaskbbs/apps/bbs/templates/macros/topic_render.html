{% macro topic_render(topic) %}
{% set user=topic.user %}
{% set profile=user.profile %}
<div class="topic">
    <div class="topic-header">
    <div class="pull-left avatar"><a href="{{user.url}}" rel="userpopover" title="{% if profile.city %}<i><span class='icon small_pin'></span>{{profile.city}}</i>{% endif %} {{user.username}}" data-content="{{profile.signature}}" class="user_avatar"><img alt="{{topic.user.username}}的头像" src="{{user.avater}}" /></a></div>
    <div class="infos">
        <h1 class="title">
            <a href="{{url_for('bp_bbs.bbs_topic', id=topic.id)}}" title="{{topic.title}}">{{topic.title}}</a>
        </h1>
        <div class="info leader">
            节点&nbsp;&nbsp;<a class="btn" href="{{url_for('bp_bbs.bbs_node', node_name=topic.node.name)}}">{{topic.node.name}}</a>&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;&nbsp;
            <a class="topic-user" href="{{user.url}}" data-name="{{user.username}}">{{user.username}}</a>&nbsp;&nbsp;|&nbsp;&nbsp;<time title="{{topic.created}}">{{topic.hr_created_tm}}</time>&nbsp;&nbsp;&nbsp;
            {% if topic.reply_count %}•&nbsp;&nbsp;&nbsp;最后回复 <a href="{{topic.last_reply_by}}" data-name="{{topic.last_reply_by}}">{{topic.last_reply_by}}</a> | <time title="{{topic.last_reply_at}}">{{topic.hr_last_reply}}</time>;&nbsp;&nbsp;{% endif %}
            •&nbsp;&nbsp;{{topic.hits}} 次阅读
        </div>
    </div>
    </div>
    <div class="topic-body">
        {{topic.content|safe}}
    </div>
</div>
{% endmacro %}